▣ 30. 계층 만들기

데이터: Superstore KR v2018.xlsx

1. 좌측 사이드바에서 차원에 있는 제품 대분류를 더블 클릭하면 행선반에 올라갑니다. 

2. 그리고 측정값의 매출값을 마우스 드래그 해서 열선반에 올려놓으시면 제품별 대분류 매출값이 막대 그래프로 그려지게 됩니다.

3. 그래프 아래에 매출 옆에 보면 조그만 아이콘이 보이는데 그걸 누르면 막대 그래프가 내림차순으로 정렬됩니다.

4. 이번에는 좌측 사이바에 제품 중분류를 드래그 해서 행선반 위에 올려놓습니다.

5. 그리고 똑같이 그래프 아래 매출 옆에 조그만 아이콘을 눌러서 정렬을 하시면 제품 대분류내에서 제품 중분류 별로 정렬을 해서 보실 수 있습니다.

6. 이번에는 좌측 사이드 바에 제품 대분류를 누르고 컨트롤 키를 누른 다음에 제품 중분류를 선택합니다.

7.  그리고 마우스 오른쪽을 누르고 맨밑에 계층에서 계층 만들기를 선택합니다.

8. 그리고 계층 만들기 박스가 나오면서 이름을 쓰는 부분이 생기는데 이름을 제품이라고 하고 확인을 누룹니다.

9. 이렇게 되면 행선반 맨앞에 제품 대분류 앞에 마이너스(-) 표시가 추가 되었습니다.

10. 여기 마이너스 버튼을 눌러보면 제품 대분류별로 매출 합계가 나오고  플러스 버튼을 눌러보면 다시 대분류, 중분류별로 매출 합계가 나옵니다.

11. 그 다음 좌측 사이드바에 제품명을 제품의 하위 데이터인 제품 중분류 밑에 둡니다.

12. 그리고 행선반 제품 중분류 앞에 플러스 버튼이 추가됩니다. 이 플러스 버튼을 누르면 제품명까지 펼쳐서 합계 매출을 따서 정렬된것을 보실 수 있습니다.

13. 두번째는 지역 계층에 대해서 살펴보겠습니다. 

14.   행선반에 있는 3개를 전부 날려버립니다.
     좌측 사이드바에 시도 필드와 시군구 필드, 지역 필드가 있습니다. 이 세가지를 조합해서 계층을 만들어보겠습니다.

15. 먼저 시도필드를 드레그해서 지역 필드위에 오버랩합니다.

16. 그리고 계층이름은 지역이라고 합니다.

17. 좌측 사이드바에 지역 밑에 지역이 있는데 이 지역 밑에 시도 밑에 시군구 필드를 드래그 해서 가져다 둡니다

18. 그러면 지역 필드에는 첫번째 지역, 두번째 시도, 세번째 시군구가 있습니다.

19. 그래서 지역을 행선반에 올립니다. 그리고 행선반에 지역 앞에 플러스를 누르면 시도가 나오고 시도 앞에 플러스를 누르면 시군구가 나옵니다.

20. 이번에는 정렬을 매출이 가장 큰 값을 기준으로 내림차순으로 정렬을 해보겠습니다.

21. 그래프에 지역 필드에 옆에 조그만 버튼 을 누르고 필드에 합계매출을 선택합니다. 

22.  그러면 수도권이 첫번째로 나옵니다. 

23. 그 다음에  그 옆에 시도도 똑같이 시도 옆에 조그만 버튼을 누르고 필드를 누르고 합계매출을 누룹니다.  

24.  그리고 시군구도 똑같이 조그만 버튼을 누르고 필드를 누르고 합계매출을 누룹니다. 그러면 서울특별시에 첫번째는 관악구인데 중구가 먼저 나오고 있습니다. 그 이유는 대구에도 중구가 있고 다른 도시에도 중구가 있기 때문입니다. 

25. 이럴때는 우리가 정렬을 할때 필드가 아니라 앞에 있는 정렬까지 다 포함하는 중첩을 누르고 합계매출을 눌러서 정렬을 합니다. 그러면 수도권이 첫번째가 나오면서 관악구가 첫번째로 나오고 있습니다.
