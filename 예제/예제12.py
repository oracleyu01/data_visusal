▣ 예제12. 커널 밀도 추정 그래프 (KDE Plot) - 할인율 분포 분석  

커널 밀도 추정(KDE, Kernel Density Estimation) 그래프는 데이터의 확률 밀도 함수를 부드럽게 추정하여 데이터의 분포를 시각적으로 나타내는 도구이다. 이를 활용하면 특정 변수(예: 할인율, 수익)의 분포 형태를 한눈에 파악할 수 있다.  

■ 1. KDE Plot이 언제 필요한가?  

- 데이터의 분포를 부드럽게 시각화하고 싶을 때 유용하다.  
- 개별 데이터 포인트의 빈도가 아닌 전체적인 분포 패턴을 파악할 때 효과적이다.  
- 예: 할인율 분포 분석, 높은 할인율과 낮은 할인율의 제품군 비교, 특정 할인율이 적용된 주문 패턴 분석  

■ 2. 문제: 전체 할인율의 분포는 어떻게 되는가?  

목적:  
- 전체 할인율의 분포가 어떤 형태를 가지는지 분석  
- 할인율이 특정 구간에 집중되어 있는지 확인  
- 높은 할인율과 낮은 할인율의 제품군 비율을 분석하여 전략 수립  

■ 3. 데이터 로드 및 Plotly KDE Plot 생성  

import pandas as pd  
import plotly.figure_factory as ff  

df = pd.read_csv("c:\\data\\SUPERSTORE_2019.csv")  

fig = ff.create_distplot([df["할인율"].dropna()], ["할인율"],  
                         show_hist=False,  
                         show_rug=True,  
                         colors=["red"])  

fig.update_layout(title="전체 할인율 분포 (KDE Plot)",  
                  xaxis_title="할인율",  
                  yaxis_title="밀도",  
                  width=800, height=600)  

fig.show()  

■ 4. 분석 결과 해석  

✅ 할인율 분포 분석  
✔ 할인율이 특정 구간에 집중되어 있는지 확인 가능  
✔ 평균적인 할인율 수준을 파악할 수 있음  

✅ 할인율 패턴 식별  
✔ 특정 할인율 구간에서 밀도가 높은 경우, 해당 할인율이 자주 적용된다는 의미  
✔ 다봉 분포(Multimodal Distribution)인 경우, 여러 개의 할인율 그룹이 존재할 가능성이 있음  

✅ 고할인 및 저할인 제품군 분석  
✔ 할인율이 낮은 제품군과 높은 제품군을 구분하여 가격 전략을 수립할 수 있음  
✔ 할인율이 극단적으로 낮거나 높은 제품군이 있다면 원인 분석이 필요  

■ 5. 추가 분석 - 할인율 분포가 정규분포를 따르는가?  

커널 밀도 추정 그래프를 통해 데이터의 분포를 시각적으로 확인할 수 있지만, 할인율 데이터가 정규성을 따르는지 검증하려면 추가적인 가설 검정을 수행해야 한다.  

import pandas as pd  
from scipy.stats import shapiro  

df = pd.read_csv("c:\\data\\SUPERSTORE_2019.csv")  

shapiro_test = shapiro(df["할인율"].dropna())  

print("Shapiro-Wilk 정규성 검정 결과:", shapiro_test)  

■ 6. 분석 결과 해석  

✅ Shapiro-Wilk 정규성 검정 결과 해석  
✔ p-value < 0.05 → 데이터가 정규성을 따르지 않음  
✔ p-value >= 0.05 → 데이터가 정규성을 따름  

✅ 분포에 따른 추가 전략  
✔ 정규 분포를 따르는 경우: 평균과 표준편차를 이용하여 할인율 예측 가능  
✔ 정규 분포를 따르지 않는 경우: 데이터 변환(로그 변환 등) 후 추가 분석 필요  

■ 7. 결론 및 실행 전략  

🚀 할인율 분포를 분석하여 특정 할인율 구간에 집중된 제품군을 파악하고, 해당 제품군에 맞는 가격 전략을 적용  
🚀 과도한 할인율이 적용된 제품을 분석하고, 수익성을 고려한 가격 조정 전략을 수립  
🚀 할인율 데이터가 정규성을 따르는지 검증하여 향후 가격 정책 및 프로모션 전략 수립에 활용  

커널 밀도 추정 그래프(KDE Plot)를 활용하면 할인율 분포를 보다 직관적으로 분석할 수 있으며, 추가적인 정규성 검정을 통해 데이터 분석의 정확도를 높일 수 있다.
