▣ 예제37.그룹과 집합

데이터: superstore KR_V2018.xls 를 이용해야함

1. 좌측 사이드바에 측정값에 있는 매출을 더블 클릭하면 행선반에 합계(매출) 이 생성됩니다.

2. 그 다음 좌측 사이드바에 차원에 있는 주문일자를 마우스 오른쪽 마우스를 누르고 드래그 해서 열선반에 올려놓습니다.

3. 그러면 필드놓기라는 창이 나오는데 거기 밑에서 5번째 있는 초록색 연속형 분기 주문일자를 더블클릭하시면 라인 그래프가 그려집니다.  분기별 매출 현황을 라인 그래프로 시각화 된겁니다. 

4. 그리고 마크를 라인이 아니라 영역으로 변경합니다.

5. 좌측 사이드바에 시도 필드에 마우스 오른쪽 누르고 만들기에서 그룹을 누룹니다. 

6. 그룹만들기에서 그룹이름을 시도그룹이라고 이름을 둡니다.

7. 그리고 경기도, 서울특별시, 인천광역시를 컨트롤키를 누르고 복수개 선택을 합니다. 그리고 하단에 그룹버튼을 누룹니다. 그리고 수도권이라고 이름을 붙입니다.  그리고 나머지 14개의 그룹은 그룹 버튼 밑에 있는 기타 포함을 체그하고 확인을 누룹니다. 

8.  좌측 사이드바에 생긴 시도그룹을 드래그 해서 색상 마크에 올려놓습니다. 

9. 그러면 1개의 덩어리가 수도권과 기타로 그래프로 각각 분리되는것을 보실 수 있습니다.

10. 행선반에 합계(매출) 의 세모 누르고 밑에서 두번째 있는 퀵테이블 계산에 네번째 있는 구성 비율을 선택합니다.

11. 행선반에 합계(매출)에 아래 세모옵션을 누르고 밑에서 네번째 있는 테이블 계산 편집을 선택합니다. 

12. 그러면 테이블 계산 편집창이 나오는데 여기서 특정 차원을 클릭하고  주문일자의 분기를 체크 해제합니다. 그리고 시도그룹은 체크된 상태로 둡니다. 그러면 그래프가 꽉차게 됩니다.

13. 그러면 시도별로 분기별로 비중을 보실수 있습니다.

14. 그리고 행선반에 합계(매출)을 컨트롤키를 누른상태에서 마우스 드레그해서 레이블에 올려주시면 그러면 각각의 분기별로 값을 살펴보실 수 있습니다. 

15. 이번에는 집합에 대해서 살펴보겠습니다.

16. 지금은 수도권과 기타를 기준으로 나눴지만 이번에는 시도 기준으로 여러개의 그룹을 만들어보겠습니다.

17. 새 시트를 누룹니다.

18. 차원 두번째 있는 고객명을 행선반에 올려놓습니다. 

19. 그리고 측정값에 있는 매출을 더블 클릭합니다. 그러면 각각의 고객별로 매출이 나타납니다. 

20. 이  상태에서 가운데 그래프 고객명 컬럼 옆을 자세히 보면 오른쪽에 세모옵션이 있고 그걸 누르고 필드에 합계(매출)을 선택하세요.

21. 그러면 매출합계 기준으로 내림차순 정렬이 됩니다.

22. 좌측 사이드바에 차원에 두번째에 있는 고객명에 아래 세모옵션을 누르고 만들기에 그룹 밑에 집합을 누룹니다.

23. 집합 만들기가 나오면 이름을 "매출 상위 10위"라고 합니다. 그리고 상위텝에 필드 기준 라디오 버튼을 누룹니다. 
그러면 매출 합계를 기준으로 상위 10명의 집합을 만들 수 있습니다. 

24. 그리고 좌측 사이드바에 차원에 생긴 "매출 상위10위"를 드래그 해서 행선반에 올려놓습니다.

25. 그러면 매출 상위 1위~10위 까지는 IN 이 나오고 있고 나머지는 OUT 이 나오고 있습니다.

26. 이번에는 차원에 있는 "매출 상위10위"에 마우스 오른쪽을 누른다음에 복제를 선택합니다.

27. 그리고 복사본의 마우스 오른쪽을 누르고 집합 편집을 선택합니다.

28.  그리고 이름을 "매출 상위20위" 로 하고 기준을 20으로 변경하겠습니다.

29. 그 다음에 차원에 있는 매출상위20위를 드래그래서 행선반에 매출 상위 10위 옆에 올려놓습니다.

30. 그러면 1위부터 20위까지는 IN 나머지는 OUT 이 나옵니다. 

31. 이번에는 차원에 "매출 상위10위" 와 "매출 상위20위"를 복수 선택해서 오른쪽 마우스를 누르고 결합된 집합 만들기 기능을 선태합니다

32. 여기에 집합 이름은 "매출 상위 11위-20위" 로 씁니다.

33. 여기에 합집합과 교집합과 여집합을 각각 클릭해서 볼 수 있습니다.

34. 세번째 여집합을 선택합니다.

35. 그리고 차원에 생긴 "매출 상위 11위-20위" 를 행선반에 세번째에 올려놓으면 11위부터 20위까지만 IN 으로 보입니다. 
