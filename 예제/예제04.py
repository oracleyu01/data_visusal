### **์์ 4. ์ฐ์๋ (Scatter Plot)**

### **1. ์ฐ์๋๊ฐ ์ธ์ ํ์ํ๊ฐ?**  
# โ ๋ ๊ฐ์ ์ฐ์ํ ๋ณ์ ๊ฐ ๊ด๊ณ๋ฅผ ์๊ฐ์์ผ๋ก ๋ถ์ํ ๋ ์์ฉํจ.  
# โ ๋ณ์ ๊ฐ ์๊ด๊ด๊ณ(correlation)๋ฅผ ํ์ํ๊ณ ํธ๋๋๋ฅผ ๋ฐ๊ฒฌํ ์ ์์.  
# โ ์: ๋งค์ถ๊ณผ ์์ต์ ๊ด๊ณ, ํ์ธ์จ๊ณผ ๋งค์ถ์ ์ํฅ, ๊ณ๊ฐ ์ฐ๋น๊ณผ ๊ตฌ๋งค ๊ธ์ก ๋ถ์ ๋ฑ.  

import pandas as pd
import plotly.express as px

# ๋ฐ์ดํฐ ๋ก๋
df = pd.read_csv('c:\\data\\SUPERSTORE_2019.csv')

# ์ฐ์๋ ์์ฑ (๋งค์ถ vs ์์ต)
fig = px.scatter(df, x='๋งค์ถ', y='์์ต',
                 title='๋งค์ถ๊ณผ ์์ต์ ๊ด๊ณ',
                 labels={'๋งค์ถ': '๋งค์ถ์ก', '์์ต': '์์ต์ก'},
                 opacity=0.7)

# ๊ทธ๋ํ ์คํ์ผ ์๋ฐ์ดํธ
fig.update_layout(xaxis_title='๋งค์ถ', yaxis_title='์์ต')
fig.show()

### **๐ ์ฐ์๋ vs ํ์คํ๊ทธ๋จ ์ฐจ์ด์**
# | ๊ทธ๋ํ ์ํ | ์ฌ์ฉ ๋ชฉ์ |
# |---|---|
# | **์ฐ์๋ (Scatter Plot)** | ๋ ๊ฐ์ ์ฐ์ํ ๋ณ์ ๊ฐ ๊ด๊ณ๋ฅผ ๋ถ์ (์: ๋งค์ถ vs ์์ต, ํ์ธ์จ vs ํ๋งค๋) |
# | **ํ์คํ๊ทธ๋จ (Histogram)** | ๋ฐ์ดํฐ์ ๋ถํฌ์ ๋น๋๋ฅผ ๋ถ์ํ๋ ๋ฐ ์ํฉ (์: ๋งค์ถ ๋ถํฌ, ๊ณ๊ฐ ์์ต๋ฅ) |

### **๐ง ์ถ๊ฐ ์ฐ์ต ๋ฌธ์**

2019๋ ๋งค์ถ๊ณผ ์์ต ๊ฐ์ ๊ด๊ณ๋ฅผ ๋ถ์ํ์ธ์.

1. ๋งค์ถ์ด ์ฆ๊ฐํ์๋ก ์์ต๋ ์ฆ๊ฐํ๋๊ฐ?

df = pd.read_csv('c:\\data\\SUPERSTORE_2019.csv')

# ๋งค์ถ-์์ต ์ฐ์๋ ์์ฑ
fig = px.scatter(df, x='๋งค์ถ', y='์์ต',
                 title='๋งค์ถ๊ณผ ์์ต์ ๊ด๊ณ',
                 labels={'๋งค์ถ': '๋งค์ถ์ก', '์์ต': '์์ต์ก'},
                 opacity=0.7)

fig.update_layout(xaxis_title='๋งค์ถ', yaxis_title='์์ต')
fig.show()

2. ์์ต์ด ์์(์์ค)์ธ ๊ฑฐ๋๊ฐ ๊ฐ์ฅ ๋ง์ด ๋ฐ์ํ๋ ๋งค์ถ ๊ตฌ๊ฐ์ ์ด๋์ธ๊ฐ?

 ์์ต์ด ์์(์์ค)์ธ ๊ฑฐ๋๋ง ํํฐ๋ง
loss_data = df[df['์์ต'] < 0]

# ์์ค์ด ๋ง์ด ๋ฐ์ํ๋ ๋งค์ถ ๊ตฌ๊ฐ ํ์ธ
loss_bins = pd.cut(loss_data['๋งค์ถ'], bins=10)  # ๋งค์ถ์ 10๊ฐ์ ๊ตฌ๊ฐ์ผ๋ก ๋๋
loss_summary = loss_data.groupby(loss_bins)['์์ต'].count().reset_index()
loss_summary.columns = ['๋งค์ถ ๊ตฌ๊ฐ', '์์ค ๊ฑฐ๋ ์']
print(loss_summary)

๋งค์ถ ๊ตฌ๊ฐ๋ณ ์์ค ๊ฑฐ๋ ์๋ฅผ ๋ถ์ํ ๊ฒฐ๊ณผ,
"(-2934.626, 590160.168]" ๊ตฌ๊ฐ(์ฆ, ์ฝ 0~590K ๋งค์ถ ๊ตฌ๊ฐ)์์ ์์ค ๊ฑฐ๋๊ฐ ๊ฐ์ฅ ๋ง์ด ๋ฐ์(2,846๊ฑด).
๋งค์ถ์ด ๋ฎ์ ๊ฒฝ์ฐ ์์ค ๋ฐ์ ๊ฐ๋ฅ์ฑ์ด ๋์์ ์๋ฏธ.

3. ์์ค์ด ๋ฐ์ํ๋ ์ฃผ์ ์์ธ์ ๋ฌด์์ผ๊น? ํ์ธ์จ์ด ๋์ ๊ฒฝ์ฐ์ผ ๊ฐ๋ฅ์ฑ์ด ์๋๊ฐ?

# ์์ค ๊ฑฐ๋์์ ํ์ธ์จ์ด ๋์์ง ๋ถ์
loss_transactions = df[df['์์ต'] < 0]
print(loss_transactions[['๋งค์ถ', '์์ต', 'ํ์ธ์จ']].describe())  # ํ์ธ์จ ํ๊ท ๋ฐ ๋ถํฌ ํ์ธ

# ํ์ธ์จ๊ณผ ์์ต์ ๊ด๊ณ๋ฅผ ์๊ฐํ
fig = px.scatter(df, x='ํ์ธ์จ', y='์์ต',
                 title='ํ์ธ์จ๊ณผ ์์ต์ ๊ด๊ณ',
                 labels={'ํ์ธ์จ': 'ํ์ธ์จ', '์์ต': '์์ต์ก'},
                 opacity=0.7)
fig.show()


4. ๋งค์ถ ๋๋น ๊ฐ์ฅ ๋์ ์์ต๋ฅ(์์ต/๋งค์ถ ๋น์จ)์ ๊ธฐ๋กํ ์์ 10๊ฐ์ ๊ฑฐ๋๋ฅผ ๋ถ์ํ์ธ์.

# ๋งค์ถ ๋๋น ๊ฐ์ฅ ๋์ ์์ต๋ฅ์ ๊ธฐ๋กํ ์์ 10๊ฐ ๊ฑฐ๋ ์ฐพ๊ธฐ
df['์์ต๋ฅ'] = df['์์ต'] / df['๋งค์ถ']
top_profit_transactions = df.nlargest(10, '์์ต๋ฅ')
print(top_profit_transactions)
