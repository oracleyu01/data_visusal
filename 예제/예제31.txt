▣ 예제31. 지리적 역활 부여하기 

데이터: Superstore KR v2018.xlsx

1. 좌측 사이드바를 보면 측정값에 위도와 경도값이 따로 없습니다. 

2. 그래서 좌측 사이드바에 차원에 국가앞에 ABC 누르고 맨 아래에 지리적 역활에서 국가/지역을 클릭하면 측정값에 경도와 위도가 추가됩니다.

3. 그리고 나서 차원에 국가를 더블 클릭합니다. 그러면 그래프에 지도가 그려지고 열선반과 행선반에는 경도와 위도가 올라갑니다.

4. 이번에는 좌측 사이드바에 차원에 시도 앞에 ABC 를 클릭하고서 맨아래에 지리적 역활에서 밑에서 두번째 있는 주시도를 선택합니다. 그리고 시도를 더블 클릭합니다.

5. 그러면 시도가 지도에 표시됩니다.

6. 이번에는 시군구 기준으로 맵에 표시해봅니다. 좌측 사이드바에 차원에 시군구 앞에 ABC 를 클릭하고 지리적 역활에서 밑에 4번째 있는 시군구를 클릭합니다. 

7. 그리고 차원에 시군구를 더블 클릭하게 되면 시군구도 지도에 표시가 됩니다.

8. 이번에는 국가, 시도, 시군구 필드를 기준으로 계층을 만들어 보겠습니다.

9. 위에 메뉴바에 분석과 맵 메뉴 아래에 있는 시트 지우기를 누룹니다. 

10. 그리고 좌측 사이드 바에서 바로 시군구를 더블 클릭합니다.

11. 그러면 우측 하단에 보면 7개의 알 수 없는 항목이 있는데 그걸 더블 클릭해봅니다.

12. 그리고 위치편집을 누룹니다. 

13. 그러면 229개 중에서 7개가 문제가 있다고 나옵니다.

14. 그 이유는 지금 위치편집 박스에 주시도를 보시면 없음이라고 나오는데요. 이유는 지금은 주시도를 가지고 오지 않고 시군구만 가져왔기 때문에 위치 일치가 불확실하다고 나오고 있습니다. 왜냐하면 강서구는 서울에도 있고 부산에도 있습니다.
또한 중구는 왠만한 대도시에는 다 있습니다. 위치 편집을 닫습니다.

15. 다시 또 시트 지우기를 선택합니다.

16. 좌측 사이드바에 시도를 드래그 해서 시군구 위에 올려놓습니다.

17. 그러면 계층 만들기가 나오는데 이름을 지도 라고 합니다.

18. 그리고 좌측 사이드바에 국가를 드래그해서 지도 필드 하위 필드인 시도 위에 위치시킵니다.

19. 지역을 행선반에 올립니다. 그러면 지역이 표로 출력됩니다.

20. 그리고 행선반 지역 옆에 시도를 올려놓으시면 각 지역별로 시도가 출력됩니다.

21. 이번에는 좌측 사이드바에 차원에 지역 왼쪽에 있는 ABC 선택을 하고 지리적 역활에 맨 밑에 만들기 원본에 시도를 누룹니다. 

22. 그러면 지역이 만들어지게 되고 이 지역을 지도 필드에 하위 필드에 있는 국가 와 시도 사이에 드래그해서 둡니다.

23. 여기서 국가를 행선반에 올려놓은 다음에 앞에 플러스를 누르면 옆으로 지역이 나오고 지역 앞에 플러스를 누르면 시도가 나오고 시도 앞에 플러스 나오면 시군구가 나옵니다. 다시 시트지우기를 누룹니다. 

24. 이번에는 맵으로 표시해보겠습니다. 좌측 사이드바에 국가를 더블 클릭합니다. 

25. 그리고 마크에 국가를 눌러면 우리나라 국가가 확대되어나오고 지역을 누르면 6개의 지역이 표시되고 시도를 누르면 17개의 시도가 표시됩니다. 시군구를 누르면 229개의 시군가가 지도에 표시가 됩니다. 
