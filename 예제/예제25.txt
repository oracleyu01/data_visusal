▣  예제25. 이중축 만들기

데이터는 영어제목의 superstore_2019.xlsx 사용하세요.

1. 좌측 사이드바 측정값에 있는 매출을 더블 클릭하게 되면 막대가 만들어지게 됩니다.

2. 이 막대는 행선반에 합계 매출로 올라가게 됩니다.

3. 매출을 더블 클릭했더니 태블로는 내장되어 있는 기능에 따라서 기본 속성이 sum 으로 되어있기 때문에 sum(매출) 로 집계가 되고 막대 그래프를 한덩어리로 만들어주게 됩니다. 

4. 이때 표현방식을 눌러보시면 태블로가 막대로 추천을 해주고 있기 때문에 막대로 나오고 있습니다.

5. 이 상태에서 첫 사이드바에서 차원 밑에서 세번째에 있는 날짜 타입의 주문일자를 더블클릭하게 되면 지금은 막대가 아니라 라인 차트를 추천하게 됩니다. 이유는 지금과 같이 한개의 날짜 속성이 있는 경우에는 라인 차트를 먼저 추천하기 때문에 마크는 막대가 아니라 라인으로 바뀐것을 보실 수 있습니다.

6. 이 상태에서 행선반에 있는 합계(매출)을 복제해보겠습니다. 합계매출을 컨트롤키를 누르고 마우스 왼쪽을 잡고 드래그해서 오른쪽으로 하나 더 추가해봅니다. 

7. 그러면 똑같은 합계매출이 상단과 하단에 표시가 되는데 마크에 맨 밑에 있는 합계(매출)(2) 를 선택하신 다음에 라인 대신에 가운데 있는 원형태로 변경합니다.

8. 그리고 하단에 있는 각각의 연도별 매출을 떼다가 상단에 있는 라인에다가 붙여봅니다. 먼저 행선반에 있는 첫번째 합계(매출) 아래 세모를 눌러보면 여기에는 이중축이 없습니다. 이중축을 적용하려면 우측 끝에 있는 합계(매출) 아래 세모 옵션을 누르고 밑에 세번째를 보시면 이중축이라는 기능이 있습니다.

9. 이중축을 눌러보시면 하나의 비쥬얼라이제이션 안에서 축을 이중으로 쓰기 때문에 이중축이라고 부르게 됩니다. 

10. 그런데 가만히 그래프를 보면 원이 라인의 정중앙에 있지 않게 됩니다. 약간 왼쪽으로 쏠려 있습니다. 이유는 왼쪽에 있는 축의 숫자와 오른쪽에 있는 숫자가 서로 일치 하지 않아서 입니다.  

11. 이런 경우에는 축을 동기화 시켜주는게 좋습니다. 오른쪽이든 왼쪽이든 상관없이 숫자있는곳에서 오른쪽 마우스를 누르고 축 동기화를 해줍니다. 그러면 라인이 원정중앙에 위치가 됩니다. 

12.  이번에는 비쥬얼라이제이션을 전체 영역으로 확대하기 위해서 툴바의 맞춤을 전체 보기로 변경합니다.

13. 그리고 마크에 있는 합계매출(2)를 선택한 다음에 크기 마크를 오른쪽으로 쭉 밀어줍니다.

14. 그리고 좌측 사이드바에 측정값의 매출을 마우스 드래그 해서 마크의 레이블에 올려놓습니다. 

15. 그리고 원밖의 매출들을 원안으로 보내보겠습니다. 그러면 마크의 레이블 영역을 선택하신 다음에 맞춤영역을 자동이 아니라 가로 가운데, 세로도 가운데로 배치합니다. 글꼴도 더 크게 키웁니다. 

16. 지금 그래프안에 각각의 연도별 매출값이 들어가 있기 때문에 양쪽에 있는 축은 활용하지 않겠습니다. 이런경우에는 왼쪽 축 숫자있는 부분에서 마우스 오른쪽을 누르고 밑에서 두번째 있는 머리끌 표시를 해제하시면 됩니다. 

17. 이번에는 연간 매출을 각각의 고객 세그먼트 별로 나눠보겠습니다. 그러면 마크를 전체 마크로 변경하신 다음에 좌측 사이드바 차원의 고객세그먼트를 전체 마크에 있는 색상위에 올려주시면 라인과 원이 전체 고객 세그먼트별로 분리된것을 보실 수 있습니다.

18. 만약에 각각의 기호에 따라서 그래프의 배경의 격자선등을 없에고 싶다면 그래프 배경에 마우스 오른쪽을 누르고 서식을 선택하면 좌측 사이드바에 서식이 나오는데 여기 상단 4번째에 있는 테두리 서식에서 행구분선과 열구분선을 없애주시면 됩니다.

19. 그다음에 행방향으로 있는 라인선도 없애버리고 싶다면 서식 다섯번째 있는 라인 서식에서 행탭에 있는 격자선을 없애 주시면 됩니다.

20. 그러면 이제 그래프가 완성이 되는데 라인은 전반적인 추세를 보는데 적합하고 원은 원안에다가 연도별 고객 세그먼트의 매출을 원안에 표시하는데 적합한 차트 형식입니다.

21. 이번에는 앞에서 살펴보았던 누적 막대 차트를 다시 그려봅니다. 새워크 시트를 선택합니다.

22. 좌측 사이드바의 차원에 있는 매출을 더블클릭하고 주문일자를 더블클릭합니다. 

23. 그다음에 마크를 라인이 아니라 막대로 변경합니다.

24. 그다음에 행선반에 있는 합계(매출)을 컨트롤 키 또는 커맨드 키를 누른다음에 마우스 왼쪽을 잡고 드래그 해서 오른쪽으로 하나더 추가를 합니다. 

25. 이번에는 마크에 있는 첫번째 합계(매출) 첫번재를 선택하신 다음에 각각의 고객 세그먼트 별로 값을 나눠보겠습니다. 좌측 사이드바 차원의 고객 세그먼트를 색상마크에 드래그해서 놓습니다. 이런 그래프를 태블로에서는 누적 막대 차트라고 부르게 됩니다.

26. 전체 막대를 색상으로구분했지만 하나씩 막대를 쌓아올린것 처럼 보여지기 때문에 누적 막대 차트라고 부릅니다. 

27. 그런데 이 막대 그래프를 하단에 가장 큰값, 상단에는 작은값으로 표현해보겠습니다.

28. 마크에 첫번째 있는 합계(매출)의 고객 세그먼트의 아래 세모옵션을 누르고 다섯번재 있는 정렬을 누르고서 정렬 기준을 필드로 하고 정렬순서를 오름차순으로 합니다. 그러면 매출의 합계기준이 오름차순으로 정렬되면서 막대 아래가 가장 큰값이 위치하게 됩니다. 

29. 이번에는 마크에 있는 합계(매출)(2)를 선택하신 다음에 여기는 막대가 아니라 간트 차트로 변경하신 다음에 이 간트와 상단에 있는 막대를 합쳐보겠습니다. 

30. 행선반에 있는 두번째 합계(매출) 옵션 세모를 누르고 밑에서 세번째 줄에 있는 이중축을 선택하시면 지금과 같이 각각 축이 생기는 이중축이 표현이 됩니다. 

31. 마크의 합계(매출)(2) 의 간트의 색상을 흰색으로 변경하겠습니다.

32. 그리고 툴바에 있는 맞춤을 표준대신에 전체보기로 변경합니다.

33.  막대 그래프 상단에 전체 매출을 볼 수 있도록 마크의 합계(매출)(2)의 레이블에 측정값에 있는 매출을 마우스로 끌어다 놓습니다.

34. 합계(매출)(1) 에도 레이블에 매출을 끌어다 놓으면 각각의 매출이 막대 그래프에 표시됩니다.

35.  그리고 이번에도 축을 동기화 시켜줍니다. 그래프 왼쪽에 숫자축에서 오른쪽 마우스를 누르고 축 동기화를 누룹니다.

36. 세번째로는 분기별 매출을 라인과 영역으로 만들어서 전반적인 추세를 볼때 등락을 강조하기 위해서 영역차트 위에 라인 차트를 표현해보겠습니다.

37. 먼저 좌측 사이드바 차원 밑에 세번째 있는 주문일자를 마우스 왼쪽 누른 상태에서 드래그 해서 열선반에 올리겠습니다.

38. 그리고 필드놓기에서 밑에서 5번째에 있는 초록색 연속형 분기 주문일자를 더블클릭하구요.

39. 그다음에 좌측 사이드바 측정값에 있는 매출을 더블 클릭합니다. 

40. 그 다음에 행선반에 있는 합계매출을 컨트롤 키 또는 커맨드 키를 누른다음에  마우스 왼쪽을 잡고 드래그해서 오른쪽으로 하나더 추가를 합니다. 

41. 그리고 마크에 맨아래 합계(매출)(1) 을 선택한다음에 여기를 영역차트로 만듭니다.

42. 하단에 있는 라인 차트를 떼어다가 영역차트에 합쳐보겠습니다.

43. 행선반에 두번째 합계(매출)(2) 의 아래 세모 옵션을 누르고 밑에서 세번째 있는 이중축을 선택하시면 영역차트 위에다가 라인 차트를 한번더 감싸면서 영역차트를 좀더 직관적으로 볼 수 있게 할 수 있습니다. 

44. 좌측 측정값에 있는 매출을 마우스 드래그 해서 마크의 합계(매출)(2) 에 레이블 위에 올려놓습니다.
